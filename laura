#!/bin/bash
# Laura - Lovable Artificially-intelligent Unflappable Research Assistant
# A friendly wrapper for launching Claude Code in research vaults

# Color codes
GREEN='\033[0;32m'
BLUE='\033[0;34m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

# Check if we're in a research vault
if [ ! -f "CLAUDE.md" ] || [ ! -d ".bloglog" ]; then
    echo -e "${YELLOW}ðŸ‘‹ Hi! I'm Laura, your research assistant.${NC}"
    echo ""
    echo "It looks like you're not in a research vault."
    echo ""
    echo "To start:"
    echo "  1. Create a vault: ./setup-vault.sh ~/vaults/my-research"
    echo "  2. Navigate to it: cd ~/vaults/my-research"
    echo "  3. Launch me: laura"
    echo ""
    exit 1
fi

# Welcome message
echo -e "${GREEN}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
echo -e "${GREEN}â•‘                                                        â•‘${NC}"
echo -e "${GREEN}â•‘  ðŸ‘‹ Hi! I'm Laura - your research assistant           â•‘${NC}"
echo -e "${GREEN}â•‘                                                        â•‘${NC}"
echo -e "${GREEN}â•‘  ${BLUE}L${NC}ovable ${BLUE}A${NC}rtificially-intelligent ${BLUE}U${NC}nflappable       ${GREEN}â•‘${NC}"
echo -e "${GREEN}â•‘  ${BLUE}R${NC}esearch ${BLUE}A${NC}ssistant                                ${GREEN}â•‘${NC}"
echo -e "${GREEN}â•‘                                                        â•‘${NC}"
echo -e "${GREEN}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
echo ""

# Read vault name from CLAUDE.md if possible
VAULT_NAME=$(grep "^# " CLAUDE.md 2>/dev/null | head -1 | sed 's/^# //' | sed 's/ - Research Context$//')
if [ -n "$VAULT_NAME" ]; then
    echo -e "${BLUE}Research vault:${NC} $VAULT_NAME"
else
    echo -e "${BLUE}Research vault:${NC} $(basename $(pwd))"
fi

# Show recent activity if BlogLog is available
if command -v bl &> /dev/null; then
    echo -e "${BLUE}Recent activity:${NC}"
    bl timeline --since "3 days ago" 2>/dev/null | head -5
    echo ""
fi

echo -e "${YELLOW}Ready to help with:${NC}"
echo "  â€¢ Research fundamentals of any topic"
echo "  â€¢ Process papers and sources"
echo "  â€¢ Build connected knowledge"
echo "  â€¢ Track your progress"
echo ""
echo -e "${YELLOW}Quick start:${NC}"
echo '  "Research the fundamentals of [topic]"'
echo '  "Process the paper I just added to sources/raw/"'
echo '  "Summarize my progress this week"'
echo ""
echo -e "${GREEN}Let's build some knowledge! ðŸš€${NC}"
echo ""

# Launch Claude Code with initial context
claude-code
